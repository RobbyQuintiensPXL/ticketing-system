version: '3.7'
services:
    zookeeper:
        image: wurstmeister/zookeeper:latest
        ports:
            - 2181:2181
    kafkaserver:
        image: wurstmeister/kafka:latest
        ports:
            - 9092:9092
        environment:
            - KAFKA_ADVERTISED_HOST_NAME=kafka
            - KAFKA_ADVERTISED_PORT=9092
            - KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
            - KAFKA_CREATE_TOPICS=events:1:1,tickets:1:1
        volumes:
            - "/var/run/docker.sock:/var/run/docker.sock"
        depends_on:
            - zookeeper
    consul:
        image: consul:latest
        ports:
            - 8500:8500
        command: agent -server -ui -node=server1 -bootstrap-expect=1 -client=0.0.0.0